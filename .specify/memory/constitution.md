<!--
Sync Impact Report:
Version change: 1.0.0 → 1.2.0 → 2.0.0
Modified principles: Added Principle VII (Automated Compliance), enhanced Principle V (Reusability and Intelligence) with detailed component requirements
Added sections:
  - Principle VII: Automated Compliance Verification
  - Violation Escalation Matrix
  - Phase Transition Gates
  - Phase-Specific Security Requirements
  - Phase-Specific Testing Requirements
  - Emergency Amendment Protocol
  - Detailed Feature Breakdowns for all 5 phases
  - Reusable Intelligence Component requirements (Subagents, Skills, Blueprints)
  - Reusable Intelligence Development Protocol (new section with agent/skill usage guidelines, governance)
Removed sections:
  - Verbose rationale paragraphs (moved to history/adr/001-constitution-rationale.md)
  - Bonus Achievement section (hackathon-specific scoring)
  - Bonus Standards section
  - Bonus Constraints section
  - Submission requirements (hackathon-specific)
Templates requiring updates:
  ⚠️ .specify/templates/plan-template.md - Add Phase Transition Gates checklist
  ⚠️ .specify/templates/spec-template.md - Add automated compliance checks reference
  ⚠️ .specify/templates/tasks-template.md - Add phase-specific test tasks
  ⚠️ .github/workflows/*.yml - Add CI enforcement for spec traceability and coverage
  ⚠️ CLAUDE.md (root/frontend/backend) - Add compliance verification guidance
Follow-up TODOs:
  - Create ADR 001 with moved rationale content
  - Implement CI checks for spec traceability
  - Create phase transition gate scripts
  - Create validation for Subagents/Skills structure
  - Create `.claude/agents/README.md` with agent catalog
  - Create `.claude/skills/README.md` with skill catalog
-->

# Evolution of Todo - Project Constitution

## Core Principles

### I. Spec-Driven Development (SDD) as Core Workflow

Every feature, phase, and implementation MUST follow the SDD lifecycle: Specify (WHAT) → Plan (HOW) → Tasks (BREAKDOWN) → Implement (CODE). No manual coding allowed; all code MUST be generated by Claude Code based on refined specs.

**Enforcement**: CI MUST fail builds where code files lack spec reference comments. Target: 100% traceability.

### II. AI-Native Architecture

Use AI agents (Claude Code, OpenAI Agents SDK) for execution, with humans as product architects. Humans define architecture; AI generates implementation.

**Enforcement**: All code commits MUST include PHR reference documenting the AI generation process.

### III. Progressive Evolution

Build incrementally across 5 phases: console app → web app → AI chatbot → local K8s → cloud deployment. Each phase MUST be fully functional before proceeding to next.

**Enforcement**: Phase transition gates (see Phase Transition Gates section) MUST pass before advancing.

### IV. Cloud-Native and Event-Driven Focus

Prioritize stateless designs, loose coupling via Kubernetes, Dapr, and Kafka. Services MUST be horizontally scalable and resilient.

**Enforcement**: Architecture reviews MUST verify statelessness (no in-memory session state). Load tests MUST demonstrate horizontal scaling.

### V. Reusability and Intelligence

Create reusable AI components (Subagents, Skills) and cloud-native blueprints. Intelligence MUST be captured and shared.

**Reusable Intelligence Components**:
- **Subagents**: Specialized agents for specific tasks (e.g., betterauth-engineer, chatkit-backend-engineer, nextjs-expert)
  - MUST be self-contained with clear domain boundaries
  - MUST include agent description, capabilities, and tool permissions
  - MUST be documented with usage examples and common patterns
  - Location: `.claude/agents/`

- **Skills**: Reusable workflows and task patterns (e.g., sp.specify, sp.plan, sp.implement)
  - MUST handle entire workflows autonomously
  - MUST include input validation and error handling
  - MUST create traceability artifacts (PHRs, ADRs)
  - Location: `.claude/skills/`

- **Blueprints**: Deployment and architecture templates
  - MUST include complete setup instructions
  - MUST be tested across multiple environments
  - MUST document configuration options and trade-offs
  - Location: `blueprints/` or similar

**Enforcement Requirements**:
- All Subagents MUST have `.md` files with: description, capabilities, usage examples, limitations
- All Skills MUST include: README, examples, input/output contracts
- Reusable components MUST be versioned and documented
- Components MUST be tested independently before integration
- CI MUST validate reusable component structure (template linting, schema validation)

### VI. Security and User Isolation

Enforce authentication, JWT-based authorization, and per-user data isolation. Zero tolerance for security vulnerabilities.

**Enforcement**: Automated security scans MUST pass (OWASP Top 10 checks). Manual penetration testing required before Phase V deployment.

### VII. Automated Compliance Verification

All compliance checks MUST be automated in CI/CD pipelines. Manual verification is insufficient for governance.

**Enforcement Mechanisms**:
- **Spec Traceability**: CI script scans all `.py`, `.ts`, `.tsx` files for `@spec:` references. Fails if <100%
- **Test Coverage**: CI fails if coverage <80% for core features (task CRUD, auth, events)
- **Security Scan**: CI runs `safety check` (Python), `npm audit` (Node), fails on HIGH/CRITICAL
- **Phase Gates**: Automated checklist validation before phase transitions (see Phase Transition Gates)

## Phase-Specific Requirements

### Phase I: Console App (Python 3.13+, UV)

**Tech Stack**: Python 3.13+, UV, Claude Code, Spec-Kit Plus

**Feature Scope - Basic Level**:
1. **Create Task** - Add a new task with title and optional description
2. **Delete Task** - Remove a task from the list
3. **List Tasks** - Display all tasks with their status
4. **View Task Details** - Show detailed information for a specific task
5. **Mark as Complete** - Mark a task as completed

**Security**:
- N/A (single-user, in-memory)

**Testing**:
- Unit tests for task CRUD operations
- Integration tests for CLI commands
- Coverage: ≥80% for core logic

**Success Criteria**:
- All 5 Basic features functional
- Tests pass
- Spec traceability: 100%

### Phase II: Web App (Next.js 16+, FastAPI, PostgreSQL)

**Tech Stack**: Next.js 16+ (App Router, TypeScript, Tailwind), FastAPI, SQLModel, Neon PostgreSQL, Better Auth (JWT)

**Feature Scope - Basic + Intermediate Level**:

**Basic Features (5)**:
1. **Create Task** - Add a new task with title and optional description
2. **Delete Task** - Remove a task from the list
3. **List Tasks** - Display all tasks with their status
4. **View Task Details** - Show detailed information for a specific task
5. **Mark as Complete** - Mark a task as completed

**Intermediate Features (5)**:
6. **Priorities** - Assign priority levels to tasks (High, Medium, Low)
7. **Tags** - Add tags to tasks for categorization
8. **Search** - Search tasks by title, description, or content
9. **Filter** - Filter tasks by status, priority, or tags
10. **Sort** - Sort tasks by date, priority, or other criteria

**Security**:
- JWT authentication with 24h expiration
- All user-scoped tables MUST have `user_id` foreign key + index
- Input validation via Pydantic (backend) + Zod (frontend)
- HTTPS enforced (development: self-signed cert acceptable)
- Secrets in `.env` files (NEVER committed to Git)

**Testing**:
- Unit tests: models, services, utilities
- Integration tests: API endpoints with auth
- E2E tests: Critical user flows (login, create task, complete task)
- Coverage: ≥80% backend, ≥70% frontend

**Success Criteria**:
- All 10 features (5 Basic + 5 Intermediate) functional
- E2E tests pass in CI
- Security scan: no HIGH/CRITICAL vulnerabilities
- Spec traceability: 100%

### Phase III: AI Chatbot (OpenAI ChatKit, Agents SDK, MCP)

**Tech Stack**: OpenAI ChatKit (frontend), OpenAI Agents SDK, Official MCP SDK, stateless MCP server

**Feature Scope - Basic + Intermediate + Advanced Level (via Natural Language)**:

**Basic Features (5)**:
1. **Create Task** - "Add a task to buy groceries"
2. **Delete Task** - "Delete the grocery task"
3. **List Tasks** - "Show me all my tasks"
4. **View Task Details** - "Tell me about task #5"
5. **Mark as Complete** - "Mark the grocery task as done"

**Intermediate Features (5)**:
6. **Priorities** - "Set the grocery task as high priority"
7. **Tags** - "Add tag 'home' to the grocery task"
8. **Search** - "Search for tasks with 'groceries'"
9. **Filter** - "Show me only high priority tasks"
10. **Sort** - "Sort my tasks by due date"

**Advanced Features (3)**:
11. **Recurring Tasks** - "Create a recurring task for weekly meetings"
12. **Due Dates** - "Set the grocery task due for tomorrow"
13. **Reminders** - "Remind me about the project task 2 hours before due"

**Security**:
- Rate limiting: 60 requests/minute per user
- Input sanitization for natural language queries (prevent prompt injection)
- MCP tools MUST validate user_id before DB operations
- All state persisted to PostgreSQL (NO in-memory sessions)

**Testing**:
- Contract tests: MCP tool schemas
- Integration tests: Agent workflows (add task, search, complete)
- AI quality tests: Validate responses for 20+ sample queries (accuracy, hallucination checks)
- Coverage: ≥80% MCP server, ≥70% agent code

**Success Criteria**:
- All 13 features (5 Basic + 5 Intermediate + 3 Advanced) via natural language
- AI quality tests: ≥90% accuracy on sample queries
- Rate limiting functional
- Spec traceability: 100%

### Phase IV: Local Kubernetes (Docker, Minikube, Helm)

**Tech Stack**: Docker, Minikube, Helm Charts, kubectl-ai, Kagent

**Feature Scope - Basic + Intermediate + Advanced Level (Local K8s Deployment)**:

**Basic Features (5)**:
1. **Create Task** - Add a new task with title and optional description
2. **Delete Task** - Remove a task from the list
3. **List Tasks** - Display all tasks with their status
4. **View Task Details** - Show detailed information for a specific task
5. **Mark as Complete** - Mark a task as completed

**Intermediate Features (5)**:
6. **Priorities** - Assign priority levels to tasks (High, Medium, Low)
7. **Tags** - Add tags to tasks for categorization
8. **Search** - Search tasks by title, description, or content
9. **Filter** - Filter tasks by status, priority, or tags
10. **Sort** - Sort tasks by date, priority, or other criteria

**Advanced Features (3)**:
11. **Recurring Tasks** - Create recurring tasks (daily, weekly, monthly)
12. **Due Dates** - Set due dates for tasks
13. **Reminders** - Configure reminders for tasks

**Security**:
- Kubernetes secrets for database credentials, JWT signing key
- Network policies: backend/frontend isolation
- RBAC: Minimal permissions for service accounts

**Testing**:
- Helm chart validation: `helm lint`, `helm template` tests
- Deployment tests: Install chart, verify all pods Running, run smoke tests
- Rollback tests: Deploy v2, rollback to v1, verify functionality
- Coverage: Chart tests + existing app tests

**Success Criteria**:
- All 13 features functional in local K8s environment
- Deploys to fresh Minikube cluster in ≤15 minutes
- All services healthy (readiness/liveness probes pass)
- Rollback tested and functional
- Spec traceability: 100%

### Phase V: Cloud Production (Dapr, Kafka, DOKS, CI/CD)

**Tech Stack**: Dapr, Kafka (Redpanda Cloud/Strimzi), DigitalOcean DOKS, GitHub Actions

**Feature Scope - Basic + Intermediate + Advanced Level (Cloud Production)**:

**Basic Features (5)**:
1. **Create Task** - Add a new task with title and optional description
2. **Delete Task** - Remove a task from the list
3. **List Tasks** - Display all tasks with their status
4. **View Task Details** - Show detailed information for a specific task
5. **Mark as Complete** - Mark a task as completed

**Intermediate Features (5)**:
6. **Priorities** - Assign priority levels to tasks (High, Medium, Low)
7. **Tags** - Add tags to tasks for categorization
8. **Search** - Search tasks by title, description, or content
9. **Filter** - Filter tasks by status, priority, or tags
10. **Sort** - Sort tasks by date, priority, or other criteria

**Advanced Features (3)**:
11. **Recurring Tasks** - Create recurring tasks (daily, weekly, monthly)
12. **Due Dates** - Set due dates for tasks
13. **Reminders** - Configure reminders for tasks

**Security**:
- Dapr secrets for all credentials
- JWT token rotation: 24h expiration, refresh tokens
- Audit logging: All user actions logged with timestamp, user_id, action
- HTTPS with valid TLS cert (Let's Encrypt)
- Network policies: Zero-trust (explicit allow rules only)

**Testing**:
- Load tests: Verify p95 latency <500ms at 100 concurrent users
- Chaos tests: Kill random pod, verify recovery <30s
- Event tests: Verify Kafka message delivery, dead-letter queue handling
- Security tests: Penetration testing report (OWASP Top 10)
- Coverage: Existing tests + production readiness tests

**Success Criteria**:
- All 13 features functional in cloud production
- Cloud deployment accessible via public URL
- Load tests pass (p95 <500ms)
- Chaos tests pass (recovery <30s)
- Security: Penetration test report with 0 HIGH/CRITICAL issues
- Observability: Centralized logs, metrics dashboards, alerts configured
- CI/CD: Automated deploy on merge to main
- Event-driven: Kafka integration tested
- JWT rotation functional
- Audit logging verified
- Spec traceability: 100%

## Reusable Intelligence Development Protocol

Our team commits to creating reusable intelligence through Claude Code's agent and skill system. This approach ensures efficiency, consistency, and scalability across all development tasks.

### Agent & Skill Usage Guidelines
- **Automatic Identification**: For any task, Claude Code will first analyze requirements and automatically invoke relevant agents/skills
- **No Redundant Instructions**: Team members should not need to repeat agent/skill specifications for similar tasks
- **Consistency**: Once an agent/skill pattern is established for a task type, it becomes the default approach
- **Documentation**: All custom agents and skills created will be documented in `.claude/agents/README.md` and `.claude/skills/*/README.md`

### Current Active Agents & Skills

**Project-Specific Skills**:
- `sp.specify` - Feature specification creation from natural language
- `sp.plan` - Architecture planning and design artifact generation
- `sp.tasks` - Actionable, dependency-ordered task breakdown
- `sp.implement` - Execute implementation plan
- `sp.phr` - Prompt History Record creation for traceability
- `sp.adr` - Architecture Decision Record creation
- `sp.clarify` - Identify underspecified areas via targeted questions
- `sp.checklist` - Generate custom checklists
- `sp.constitution` - Constitution management

**Specialized Agents**:
- `betterauth-engineer` - Better Auth integration and onboarding
- `chatkit-backend-engineer` - OpenAI ChatKit Python backend (Agents SDK)
- `chatkit-frontend-engineer` - ChatKit frontend widgets and UI embedding
- `nextjs-engineer` - Next.js expertise
- `fullstack-engineer` - Full-stack coordination
- `prompt-engineer` - Prompt optimization
- `ui-ux-designer` - Design specifications

**Technology-Specific Skills**:
- `nextjs-expert` - Next.js best practices and patterns
- `openai-chatkit-backend-python` - ChatKit Python backend
- `openai-chatkit-frontend-embed-skill` - ChatKit frontend embedding

### Creating New Reusable Components

When a task pattern is repeated >2 times, we will:
1. **Identify the Pattern**: Analyze recurring tasks that have similar structure/requirements
2. **Create Reusable Component**: Build agent or skill to handle the pattern
3. **Test Thoroughly**: Validate across multiple scenarios and edge cases
4. **Document Usage**: Add README with examples, input contracts, and known limitations
5. **Version and Release**: Add to permanent toolkit with clear versioning
6. **Update Constitution**: Reference new component in relevant sections

### Reusable Intelligence Governance

**Quality Standards**:
- All agents MUST include: description, capabilities, tool permissions, usage examples
- All skills MUST include: README, input/output contracts, examples, error handling
- Components MUST be tested independently before production use
- Components MUST create traceability artifacts (PHRs, ADRs) where applicable

**CI/CD Integration**:
- Agent structure validation in `.claude/agents/`
- Skill template validation in `.claude/skills/`
- Documentation completeness checks (README, examples, contracts)

**Maintenance**:
- Regular review of component usage patterns
- Refactoring opportunities for frequently-invoked components
- Deprecation process for obsolete components

---

## Key Standards

### Development Process

**Spec-Kit Plus Structure**:
- `/specs/overview.md` - Project overview
- `/specs/features/*.md` - Feature specs with user stories
- `CLAUDE.md` - Agent guidance (root, frontend, backend)
- All specs MUST include: user stories, acceptance criteria, artifact links

**Spec References in Code**:
```python
# @spec: specs/features/001-task-crud.md
# User Story 1: Create Task
def create_task(user_id: int, title: str) -> Task:
    ...
```

**Enforcement**: CI script validates `@spec:` comments exist in all source files.

### Tech Stack Compliance

See Phase-Specific Requirements above for full tech stack per phase.

**Non-Negotiable**:
- Phase I: Python 3.13+, UV
- Phase II: Next.js 16+, FastAPI, SQLModel, Neon PostgreSQL, Better Auth
- Phase III: OpenAI ChatKit, OpenAI Agents SDK, Official MCP SDK
- Phase IV: Docker, Minikube, Helm
- Phase V: Dapr, Kafka, DigitalOcean DOKS (or AKS/GKE/OKE with ADR justification)

### Code Standards

**Clean Code** (MUST):
- Follow PEP 8 (Python), ESLint/Prettier (TypeScript)
- Meaningful names (no single-letter except loop counters)
- Explicit error handling (no bare try/except or empty catch)

**Database** (MUST):
- SQLModel ORM only
- `user_id` foreign key + index on all user-scoped tables
- Migrations for schema changes (Alembic)

**API** (MUST):
- Pydantic input validation
- Consistent error format: `{"error": "message", "code": "ERROR_CODE"}`
- Auth middleware on protected endpoints
- MCP tools stateless, DB-persisted state

**Event-Driven** (MUST):
- Kafka events for state changes (task created, completed, etc.)
- Event schema: `{"event_type": str, "timestamp": ISO8601, "user_id": int, "payload": dict}`
- Retry with exponential backoff, dead-letter queue for failures

**Testing** (MUST):
- TDD: Red-Green-Refactor
- Coverage: ≥80% core features
- Tests in specs before implementation

**Documentation** (MUST):
- `README.md`: Setup, prerequisites, quickstart
- `CLAUDE.md`: Agent constraints, patterns, pitfalls
- `history/`: Preserve all specs, PHRs, ADRs

### Monorepo Structure

```
Root:
├── .spec-kit/config.yaml
├── .github/workflows/          # CI/CD with compliance checks
├── specs/
│   ├── overview.md
│   └── features/
├── CLAUDE.md
├── frontend/
│   ├── src/
│   └── CLAUDE.md
├── backend/
│   ├── src/
│   └── CLAUDE.md
├── docker-compose.yml
├── helm/                       # Phase IV: Helm charts
└── history/
    ├── prompts/
    └── adr/
```

## Constraints

### No Manual Coding

All code MUST be Claude Code-generated from specs.

**Enforcement**: PRs MUST include PHR reference. Reviewers MUST verify PHR exists and matches changes.

### Phase Dependencies

Phases MUST be completed sequentially. Phase N+1 blocked until Phase N passes transition gates.

**Enforcement**: See Phase Transition Gates section below.

### Stateless Design

Services MUST be stateless. All session state in PostgreSQL.

**Enforcement**: Code reviews MUST reject in-memory session storage. Load tests MUST verify multi-instance compatibility.

### Deployment

- Phase IV: Minikube (local)
- Phase V: DigitalOcean DOKS (or AKS/GKE/OKE with ADR)

### Resource Limits

Free tiers ONLY: Neon free DB, Redpanda Serverless, DigitalOcean $200 credit.

**Enforcement**: Cost tracking MUST be documented. Overruns require architect approval.

### Feature Scope

**Exact Features per Level**:
- Basic: CRUD + Complete
- Intermediate: Priorities, Tags, Search, Filter, Sort
- Advanced: Recurring, Due dates, Reminders

**Enforcement**: Feature additions require spec amendment + constitution compliance check.

## Phase Transition Gates

Each phase MUST pass these gates before advancing:

### Phase I → Phase II Gate

- [ ] All Basic features functional (manual demo)
- [ ] Unit + integration tests pass
- [ ] Test coverage ≥80%
- [ ] Spec traceability: 100% (automated check)
- [ ] Demo video recorded
- [ ] Phase I ADR created (technology choices)

### Phase II → Phase III Gate

- [ ] All Basic + Intermediate features functional
- [ ] E2E tests pass in CI
- [ ] Security scan: 0 HIGH/CRITICAL vulnerabilities
- [ ] JWT auth functional (manual test)
- [ ] Database migrations tested (up + down)
- [ ] Test coverage: ≥80% backend, ≥70% frontend
- [ ] Spec traceability: 100%
- [ ] Demo video recorded
- [ ] Phase II ADR created (architecture decisions)

### Phase III → Phase IV Gate

- [ ] All Basic + Intermediate + Advanced features via NL
- [ ] AI quality tests: ≥90% accuracy
- [ ] Rate limiting functional (load test)
- [ ] MCP tools contract tests pass
- [ ] Stateless design verified (multi-instance test)
- [ ] Test coverage: ≥80% MCP server
- [ ] Spec traceability: 100%
- [ ] Demo video recorded
- [ ] Phase III ADR created (AI architecture)

### Phase IV → Phase V Gate

- [ ] Helm chart deploys to Minikube in ≤15 minutes
- [ ] All pods Running + readiness probes pass
- [ ] Rollback tested (v2→v1 successful)
- [ ] Kubernetes secrets configured correctly
- [ ] Network policies functional
- [ ] Smoke tests pass post-deployment
- [ ] Test coverage maintained
- [ ] Spec traceability: 100%
- [ ] Demo video recorded
- [ ] Phase IV ADR created (K8s architecture)

### Phase V Completion Gate

- [ ] Cloud deployment accessible (public URL)
- [ ] Load tests: p95 <500ms at 100 users
- [ ] Chaos tests: Recovery <30s
- [ ] Penetration test: 0 HIGH/CRITICAL issues
- [ ] Observability: Logs, metrics, alerts configured
- [ ] CI/CD: Automated deploy functional
- [ ] Event-driven: Kafka integration tested
- [ ] JWT rotation functional
- [ ] Audit logging verified
- [ ] Test coverage maintained
- [ ] Spec traceability: 100%
- [ ] Final demo video recorded
- [ ] Phase V ADR created (production architecture)

**Enforcement**: Project lead MUST sign off on gate checklist before advancing.

## Violation Escalation Matrix

| **Severity** | **Violation Examples** | **Consequence** | **Remediation** |
|-------------|----------------------|----------------|-----------------|
| **P0 - Critical** | Security vulnerability (HIGH/CRITICAL), Manual coding without spec, Spec traceability <90% | PR blocked, immediate fix required | Fix within 24h or revert changes |
| **P1 - High** | Test coverage <80%, Missing phase gate item, Tech stack violation | PR blocked, fix before merge | Fix within 48h, escalate to architect if blocked |
| **P2 - Medium** | Missing documentation, Incomplete PHR, Weak error handling | PR approved with conditions | Fix within 1 week, tracked in follow-up task |
| **P3 - Low** | Code style violations, Missing comments, Minor documentation gaps | PR approved, non-blocking | Fix opportunistically, batch with related changes |

**Escalation Path**: Developer → Tech Lead → Project Architect → Constitution Amendment

**Override Authority**: Only Project Architect can override P0/P1 violations with explicit written justification in PR.

## Success Criteria

### Full Phase Completion

All 5 phases with working deliverables + demo videos + passing tests.

**Verification**: Phase transition gates MUST all pass.

### Spec-Driven Fidelity

100% code traceability to specs.

**Verification**: CI automated check for `@spec:` comments in all source files.

### Functionality Verification

**Per Phase**: See Phase-Specific Requirements above.

**Automated Tests**: All tests MUST pass in CI before merge.

### Deployment Stability

**Phase IV**: Minikube deploy ≤15 min, rollback functional
**Phase V**: Cloud deploy accessible, p95 <500ms, chaos recovery <30s

**Verification**: Automated deployment tests + load tests in CI.

### Overall Quality

Zero HIGH/CRITICAL vulnerabilities. All core features functional and tested.

**Security**: Automated scans + penetration testing report.

**Quality Gates**: All tests pass, coverage ≥80%, dependency scans clean, PHRs complete.

### Alignment Check

All artifacts comply with constitution.

**Verification**: Phase gate checklists + automated CI checks.

## Governance

### Amendment Process

**Requirements**:
1. Documented rationale
2. Impact analysis
3. Migration plan
4. Architect approval

**Version Bumping**:
- MAJOR (X.0.0): Breaking changes (principle removal/redefinition)
- MINOR (0.X.0): New principles/sections
- PATCH (0.0.X): Clarifications, wording fixes

**Approval**: Project Architect MUST approve MINOR/MAJOR. Tech Lead can approve PATCH.

### Emergency Amendment Protocol

**Trigger**: Critical security vulnerability requiring immediate constitution update.

**Process**:
1. Security issue identified (CVSS ≥9.0 or active exploit)
2. Architect notified immediately (Slack/WhatsApp)
3. Emergency amendment drafted within 4 hours
4. Amendment approved via async vote (2 of 3: Architect, Tech Lead, Security Lead)
5. Constitution updated within 24 hours of discovery
6. Retrospective ADR created within 48 hours

**Version Bump**: PATCH if clarification, MINOR if new security requirement, MAJOR if principle change.

**Example**: If JWT vulnerability found, emergency amendment adds "JWT MUST use RS256 (not HS256)" to Phase II security requirements. Version: 1.2.0 → 1.3.0 (MINOR).

### Compliance Review

**PR Checklist** (Automated in CI):
- [ ] Code references generating spec (`@spec:` comments)
- [ ] Spec aligns with SDD principles
- [ ] Tech stack matches phase requirements
- [ ] Security standards enforced (automated scan passes)
- [ ] Testing requirements met (coverage ≥80%)
- [ ] PHR created and linked in PR description

**Enforcement**: CI MUST block PRs failing critical checks (P0/P1 violations). Overrides require architect approval in PR comments.

### Complexity Justification

Use `plan-template.md` Complexity Tracking section for violations.

**Examples Requiring Justification**:
- Additional architectural layer (e.g., repository pattern)
- Additional service (e.g., 4th microservice)
- Non-standard tech (e.g., different ORM)

**Approval**: Architect MUST approve complexity before implementation.

### Runtime Development Guidance

`CLAUDE.md` files MUST include:
- Automated compliance verification commands
- Spec reference comment format examples
- Phase-specific security/testing patterns
- Common violation examples and fixes

---

**Version**: 2.0.0 | **Ratified**: 2025-12-25 | **Last Amended**: 2025-12-27

**Changes in v2.0.0**:
- MAJOR update: Added detailed feature breakdowns for all 5 phases with specific feature lists
- Each phase now includes explicit feature counts (Basic: 5, Intermediate: 5, Advanced: 3)
- Added natural language examples for Phase III AI features
- Expanded Principle V (Reusability and Intelligence) with detailed requirements for Subagents, Skills, and Blueprints
- Added new section: "Reusable Intelligence Development Protocol" with:
  - Agent & Skill usage guidelines
  - Catalog of current active agents and skills
  - Process for creating new reusable components
  - Governance and quality standards
  - CI/CD integration requirements
  - Maintenance procedures
- Added enforcement requirements for reusable AI components
- Removed hackathon-specific sections (judging, prizes, submission, bonus points)
- Constitution now focuses exclusively on technical/architectural principles and development standards
